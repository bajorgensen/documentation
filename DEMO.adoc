:toc:
= DEMO Guide: City Breaks 

[NOTE]
This demo guide is intended for a reference and **prompt** for speakers who are showing this to an audience. These instructions are designed for people who know OpenShift and have run through the link:LAB.adoc[lab] several times before. It should not be used to learn how to use the project. For that, run through the more detailed link:LAB.adoc[lab instructions].

= The first service: `public-shopping-website`

== Setup (if not demoing S2I)

Use the *.NET Core* Source-2-image builder.

include::includes/projectSetup.adoc[]

== Demo Scenarios

=== Business: Our city-breaks website should be web-scale! It needs to handle lots of orders.

* Introduce the city-breaks concept, and different roles.


=== Developer: I want to quickly get our .NET website into a container

* *Time to complete:* 5 minutes
* *Showcase features*: 
** Build a non-container app with **.NET S2I** in seconds

==== Steps to Demo 

. Create a new project 
. Browse to the service catalog, select **.NET Core** Source-2-image builder
. Complete as follows;

include::includes/projectSetup.adoc[]

. Look at S2I Build process
.. Highlight the "pushed to registry" - a container has been built
. Look at the overview, to see deployment
. Click on the "route" to see the app

=== Developer: I want to see that the app I deployed is working

* *Time to complete:* 5 minutes
* *Showcase features*: 
** **Multivariate testing:** eg: test features on real users
** **A/B deployments:** eg: ease new app version into production

==== Steps to demo

. Deploy master branch
. Add to project again, use **advanced options** to specify the *feature_weather* branch.
.. Do _not_ deploy a new route.
. Edit route, **Split traffic across multiple services**
. View app and refresh to see two versions

=== Developer: I now want to test a feature branch for multivariate testing or A/B deployments 

* *Time to complete:* 5 minutes
* *Showcase features:* 
** Deploying a paralell feature branch enables use cases like multicariate testing or A/B deployments

==== Steps to demo

. Add to the project again, with a .NET Core Builder
. This time use **advanced options** to specify the *feature_weather* branch
. Do _not_ deploy a new route
. Edit route, *split traffic across multiple services*, select the new feature branch.
. View the application, see the original or the new feature.

=== Developer: I want to use feature toggles to enable experimental features 

* *Time to complete:* 5 minutes
* *Showcase features:* 
** Feature toggles in containers simply implemented with environment variables

==== Steps to demo

. Show the application without population being shown.
. Edit the **Deployment Configuration** and set the `SHOW_POPULATION` variable to any non-empty value.
. Watch the application redeploy, or trigger a redeploy manually
. Show the application with population being shown. 

=== Operations: I need to scale a deployment because I think there will be more traffic

* *Time to complete:* 3 minutes
* *Showcase features*: 
** Super easy scaling

==== Steps to demo

. Show the frontend application on one side of the screen
. On the other side, show the OpenShift console
. Start hitting refresh on the application, and click the pod scale-up button
. Notice no loss in service
. Extra: Redeploy the app to show several pods moving to a new deployment.

=== Operations: I want it to scale automatically based on CPU load

. Deployment Configuration, add Autoscaler;
. Set the following:
** **Min pods**: 3
** **Max pods**: 5
** **CPU Request target**: 50%
. Visit deployment again, see that it is working

=== Operations: I want the application traffic to be encrypted

* **Time to complete**: 5 minutes
* **Showcase features**: TLS with the following;
** Re-encrypt
** Passthru
** Edge

. Edit route
. Tick `secure route`
. TLS Termination: **Edge**
. Insecure traffic: **Redirect**
. Talking point: Your own certificates
. Visit route again, accept self signed certificate

=== Developer: I need to connect to a database

**Not yet complete**

* *Time to complete:* 5 minutes
* *Showcase features*:
** Database connectivity

==== Steps to demo

. Edit the **deployment** configuration with the following;
** `DATABASE_USERNAME`
** `DATABASE_PASSWORD`

